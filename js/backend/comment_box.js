"use restrict";$('document').ready(function () {    $('#form_comment').on('submit', function (e) {        e.preventDefault();        var _this = $(this);        var link = $('#form_comment').attr('action');        var data = {            article_id: _this.find('.article_id').val(),            comment_text: $.trim(_this.find('.comment_text').val()),            username: $('#real_user_name').val()        };        if (data.comment_text == '') {            return false;        } else {            var comment = $(comment_template);            comment.find('.time').html('Just now');            comment.find('.comment_text').html(data.comment_text);            comment.find('.user').html(data.username);            _this.parent().find('.comment_row').prepend(comment.hide().fadeIn('slow'));            _this.find('.comment_text').val('');            $.ajax({                url: link,                type: 'POST',                data: data,                dataType: 'json',                success: function () {                }            });            return false;        }    });    //$('.comment_emoticons').emoticonize();});function add_reply(obj) {    var _this = obj;    var data = {        article_id: _this.parents('div.post-footer').find('.article_id').val(),        reply_text: _this.find('.reply_text').val(),        comment_id: _this.parents('li.element_cmt').find('.comment_id').val(),        parent_id: _this.parents('li.element_cmt').find('.comment_id').val(),        username: $('#real_user_name').val()    };    if (_this.parents('li.comment').find('.element_reply').length > 0 || _this.parents('li.element_cmt').find('.form_edit_cmt').length > 0) {        _this.parents('li.element_cmt').find('.form_edit_cmt').remove();    } else {        list_rep = [];        months = ["January","February","March","April","May","June","July","August","September","October","November","December"];        $.ajax({            type: 'POST',            url: '/comment/viewReplyByComment',            data: data,            dataType: 'json',            success: function (data) {                data.forEach(function(row) {                    var date = new Date(row.datetime_reply * 1000);                    var fullDay = months[date.getMonth()] + ' ' + (date.getDate() < 10 ? '0' : '') + date.getDate() + ' at ' + (date.getHours() < 10 ? '0' : '') + date.getHours() + ':' + (date.getMinutes() < 10 ? '0' : '') + date.getMinutes() + (date.getHours() < 12 ? 'am' : 'pm');                    replies = $(reply_list);                    replies.find('.user_reply').html(row.username);                    replies.find('.user_time').html(fullDay);                    replies.find('.reply_text').html(row.reply_text);                    replies.find('.reply_id').val(row.reply_id);                    replies.find('.owner_rep').val(row.user_id);                    list_rep.push(replies);                });                _this.parents('li.element_cmt').find('.reply_list').prepend(list_rep);            }        });    }    //$('.comment_emoticons').emoticonize();    if (_this.parents('li.element_cmt').find('.form_reply').length > 0) {        _this.parents('li.element_cmt').find('.form_reply').remove().fadeOut('slow');    }    else {        //var comment_text = _this.parents('p').siblings('div.comment-body').find('.comment_text').html();        var comment_id = _this.parents('li.comment').find('.comment_id').val();        var article_id = _this.parents('div.post-footer').find('.article_id').val();        var formReply = $(form_reply);        _this.parents('li.element_cmt').find('div.comment_heading').append(formReply);    }}function textAreaAdjust(o) {    var _this = o;    var offset = _this.offsetHeight - _this.clientHeight;    var resizeTextarea = function(el) {        jQuery(el).css('height', 'auto').css('height', el.scrollHeight + offset);    };    jQuery(_this).on('keyup input', function() { resizeTextarea(_this); }).removeAttr('data-autoresize');}function reply_form(form) {    var _this = form;    var data = {        article_id: _this.parents('div.post-footer').find('.article_id').val(),        reply_text: $.trim(_this.find('.reply_text').val()),        comment_id: _this.parents('div.comment-body').find('.comment_id').val(),        parent_id: _this.parents('div.comment-body').find('.comment_id').val(),        username: $('#real_user_name').val()    };    if (data.reply_text == '') {        return false;    } else {        $.ajax({            url: '/comment/reply',            type: 'POST',            data: data,            dataType: 'json',            success: function () {                reply = $(reply_list);                reply.find('.user_reply').html(data.username);                reply.find('.user_time').html('Just now');                reply.find('.reply_text').html(data.reply_text);                reply.find('.owner_rep').html(data.user_id);                _this.parents('li.element_cmt').find('.reply_list').prepend(reply.hide().fadeIn('slow'));                //$('.comment_emoticons').emoticonize();            },            error: function (error) {                alert('Error: ' + error.responseText)            }        });        _this.find('.reply_text').val('');        return false;    }}function edit_cmt_form(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0 || _this.parents('li.element_cmt').find('.owner_cmt').val() != $('#real_user_id').val()) {        $('#notAllowModal').modal('show');    } else {        comment_text = _this.parents('li.element_cmt').find('.comment_text').html();        comment_id = _this.parents('li.element_cmt').find('.comment_id').val();        var edit_comment = $(edit_comment_template);        if (_this.parents('li.element_cmt').find('.form_reply').length > 0) {            _this.parents('li.element_cmt').find('.form_reply').remove()        }        if (_this.parents('li.element_cmt').find('.form_edit_cmt').length > 0) {            _this.parents('li.element_cmt').find('.form_edit_cmt').remove().fadeOut('slow');        } else {            edit_comment.find('.edit_comment_text').val(comment_text);            edit_comment.find('.comment_id').val(comment_id);            _this.parents('li.element_cmt').find('div.comment_heading').append(edit_comment);        }    }}function editComment(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0) {        $('#notAllowModal').modal('show');    } else {        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            comment_id: _this.parents('div.comment_heading').find('.comment_id').val(),            comment_text: $.trim(_this.find('.edit_comment_text').val()),            username: $('#real_user_name').val(),            user_id: $('#real_user_id').val(),            owner_cmt: _this.parents('li.element_cmt').find('.owner_cmt').val()        };        if (data.comment_text == '') {            return false;        } else {            $.ajax({                type: 'POST',                url: '/comment/editComment',                data: data,                dataType: 'json',                success: function () {                    $('.comment_emoticons').emoticonize();                    _this.parents('li.element_cmt').find('.comment_text').html(data.comment_text);                    _this.parents('li.element_cmt').find('.form_edit_cmt').remove();                },                error: function (error) {                    alert('Error: ' + error.responseText);                    _this.parents('li.element_cmt').find('.form_edit_cmt').remove();                }            });            return false;        }    }}function cmt_del(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0 || _this.parents('li.element_cmt').find('.owner_cmt').val() != $('#real_user_id').val()) {        $('#notAllowModal').modal('show');    } else {        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            user_id: $('#real_user_id').val(),            comment_id: _this.parents('li.element_cmt').find('.comment_id').val(),            comment_text: _this.parents('li.element_cmt').find('.comment_text').html(),            owner_cmt: _this.parents('li.element_cmt').find('.owner_cmt').val()        };        $.ajax({            url: '/comment/deleteComment',            type: 'POST',            data: data,            dataType: 'json',            success: function () {                _this.parents('li.comment').remove();            },            error: function (error) {                alert('Error: ' + error.responseText);            }        });    }}function like_cmt(obj) {    if ( $('#real_user_id').val() == 0) {        $('#loginModal').modal('show');    } else {        var _this = obj;        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            user_id: $('#real_user_id').val(),            user_name: $('#real_user_name').val(),            comment_id: _this.parents('li.element_cmt').find('.comment_id').val(),            owner: _this.parents('li.element_cmt').find('.owner_cmt').val()        };        var like_number = parseInt(_this.find('span').html());        $.ajax({            url: '/comment/like',            type: 'POST',            data: data,            dataType: 'json',            success: function () {                _this.find('span').html(like_number + 1);                //_this.attr('onclick', 'unlike_cmt($(this))');            },            error: function () {                _this.find('span').html(like_number - 1);            }        });    }}//function unlike_cmt(obj) {//    var _this = obj;////    var data = {//        article_id: _this.parents('div.post-footer').find('.article_id').val(),//        user_id: $('#real_user_id').val(),//        user_name: $('#real_user_name').val(),//        comment_id: _this.parents('li.element_cmt').find('.comment_id').val(),//        owner: _this.parents('li.element_cmt').find('.owner_cmt').val()//    };//    var like_number = parseInt(_this.find('span').html());////    $.ajax({//        url: '/comment/unlike',//        type: 'POST',//        data: data,//        dataType: 'json',//        success: function () {//            _this.find('span').html(like_number - 1);//            _this.attr('onclick', 'like_cmt($(this))');//        },//        error: function (error) {//            alert('Error: ' + error.responseText);//        }//    });//}function edit_reply_form(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0 || _this.parents('li.element_cmt').find('.owner_rep').val() != $('#real_user_id').val()) {        $('#notAllowModal').modal('show');    } else {        reply_text = _this.parents('li.element_reply').find('.reply_text').html();        reply_id = _this.parents('li.element_reply').find('.reply_id').val();        var edit_reply = $(edit_reply_template);        if (_this.parents('li.element_reply').find('.form_reply').length > 0) {            _this.parents('li.element_reply').find('.form_reply').remove()        }        if (_this.parents('li.element_reply').find('.form_edit_reply').length > 0) {            _this.parents('li.element_reply').find('.form_edit_reply').remove().fadeOut('slow');        } else {            edit_reply.find('.edit_reply_text').val(reply_text);            edit_reply.find('.reply_id').val(reply_id);            _this.parents('li.element_reply').find('div.reply_body').append(edit_reply);        }    }}function editReply(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0  || _this.parents('li.element_cmt').find('.owner_rep').val() != $('#real_user_id').val()) {        $('#notAllowModal').modal('show');    } else {        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            reply_id: _this.parents('div.reply_body').find('.reply_id').val(),            owner_rep: _this.parents('li.element_reply').find('.owner_rep').val(),            parent_id: _this.parents('li.element_cmt').find('.comment_id').val(),            reply_text: $.trim(_this.find('.edit_reply_text').val()),            username: $('#real_user_name').val(),            user_id: $('#real_user_id').val()        };        if (data.reply_text == '') {            return false;        } else {            $.ajax({                type: 'POST',                url: '/comment/editReply',                data: data,                dataType: 'json',                success: function () {                    //$('.comment_emoticons').emoticonize();                    _this.parents('li.element_reply').find('.reply_text').html(data.reply_text);                    _this.parents('li.element_reply').find('.form_edit_reply').remove();                },                error: function (error) {                    alert('Error: ' + error.responseText);                    _this.parents('li.element_reply').find('.form_edit_reply').remove();                }            });            return false;        }    }}function reply_del(obj) {    var _this = obj;    if ( $('#real_user_id').val() == 0 || _this.parents('li.element_cmt').find('.owner_rep').val() != $('#real_user_id').val()) {        $('#notAllowModal').modal('show');    } else {        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            user_id: $('#real_user_id').val(),            user_name: $('#real_user_name').val(),            reply_id: _this.parents('li.element_reply').find('.reply_id').val(),            owner_rep: _this.parents('li.element_reply').find('.owner_rep').val(),            reply_text: _this.parents('li.element_reply').find('.reply_text').val(),            comment_id: _this.parents('li.element_cmt').find('.comment_id').val()        };        $.ajax({            url: '/comment/deleteReply',            type: 'POST',            data: data,            dataType: 'json',            success: function () {                _this.parents('li.element_reply').remove();            },            error: function (error) {                alert('Error: ' + error.responseText);            }        });    }}function like_reply(obj) {    if ( $('#real_user_id').val() == 0) {        $('#loginModal').modal('show');    } else {        var _this = obj;        var data = {            article_id: _this.parents('div.post-footer').find('.article_id').val(),            user_id: $('#real_user_id').val(),            user_name: $('#real_user_name').val(),            comment_id: _this.parents('li.element_reply').find('.reply_id').val(),            owner: _this.parents('li.element_reply').find('.owner_rep').val()        };        var like_number = parseInt(_this.find('span').html());        $.ajax({            url: '/comment/like',            type: 'POST',            data: data,            dataType: 'json',            success: function () {                _this.find('span').html(like_number + 1);                //_this.attr('onclick', 'unlike_reply($(this))');            },            error: function () {                _this.find('span').html(like_number - 1);            }        });    }}function unlike_reply(obj) {    var _this = obj;    var data = {        article_id: _this.parents('div.post-footer').find('.article_id').val(),        user_id: $('#real_user_id').val(),        user_name: $('#real_user_name').val(),        comment_id: _this.parents('li.element_reply').find('.reply_id').val(),        owner: _this.parents('li.element_reply').find('.owner_rep').val()    };    var like_number = parseInt(_this.find('span').html());    $.ajax({        url: '/comment/unlike',        type: 'POST',        data: data,        dataType: 'json',        success: function () {            _this.find('span').html(like_number - 1);            _this.attr('onclick', 'like_reply($(this))');        },        error: function (error) {            alert('Error: ' + error.responseText);        }    });}